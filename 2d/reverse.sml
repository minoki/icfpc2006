datatype 'a list = Inl of 'a * 'a list | Inr of unit
fun r acc xs = case xs of
                   Inl (y,ys) => r (Inl (y,acc)) ys
                 | Inr () => acc
fun rev xs = r (Inr ()) xs
(*
rm rev.2d
/bin/umodem rev.2d STOP
,......|..............................................,
:r     v                                              :
:*=============*   *=======*                          :
:!case N of E,S!-->!split W!--------------------+     :
:*=============*   *=======*                    |     :
: |                       |                     |     :
: |                       v                     v     :
: | *=================*  *==================*  *=====*:
--#>!send[(W,S),(W,E)]!->!send[(Inl(N,W),E)]!->!use r!-
: | *=================*  *==================*  *=====*:
: |            |                                      :
: |            v                                      :
: |     *===========*                                 :
: +---->!send[(N,E)]!----------------------------------
:       *===========*                                 :
,.....................................................,
,.....|...................,
:rev  v                   :
:*=====================*  :
:!send[(Inr(),S),(N,E)]!+ :
:*=====================*v :
:         |        *=====*:
:         +------->!use r!-
:                  *=====*:
,.........................,STOP
verify rev rev.2d
program area=1375
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|.............................................,
:r     v                                             :
:*=============*  *=======*                          :
:!case N of E,S!->!split W!--------------------+     :
:*=============*  *=======*                    |     :
:++*=================*|                        |     :
-#>!send[(W,S),(W,E)]!#-----+                  |     :
:| *=================*|     v                  v     :
:|           |        | *==================*  *=====*:
:|           v        +>!send[(Inl(W,N),E)]!->!use r!-
:|     *===========*    *==================*  *=====*:
:+---->!send[(N,E)]!----------------------------------
:      *===========*                                 :
,....................................................,
,.....|...................,
:rev  v                   :
:*=====================*  :
:!send[(Inr(),S),(N,E)]!+ :
:*=====================*v :
:         |        *=====*:
:         +------->!use r!-
:                  *=====*:
,.........................,STOP
verify rev rev.2d
program area=1242
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|.....................................,
:r     v                        +---------+  :
:*=============*  *=======*     |         v  :
:!case N of E,S!->!split W!-----+     *=====*:
:*=============*  *=======*         +>!use r!-
:++*=================*|             | *=====*:
-#>!send[(W,S),(W,E)]!#-----+       +-------+:
:| *=================*|     v               |:
:|           |        | *==================*|:
:|           v        +>!send[(Inl(W,N),E)]!+:
:|     *===========*    *==================* :
:+---->!send[(N,E)]!--------------------------
:      *===========*                         :
,............................................,
,.....|...................,
:rev  v                   :
:*=====================*  :
:!send[(Inr(),S),(N,E)]!+ :
:*=====================*v :
:         |        *=====*:
:         +------->!use r!-
:                  *=====*:
,.........................,STOP
verify rev rev.2d
program area=1058
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|.....................................,,.....|...................,
:r     v                        +---------+  ::rev  v                   :
:*=============*  *=======*     |         v  ::*=====================*  :
:!case N of E,S!->!split W!-----+     *=====*::!send[(Inr(),S),(N,E)]!+ :
:*=============*  *=======*         +>!use r!-:*=====================*v :
:++*=================*|             | *=====*::         |        *=====*:
-#>!send[(W,S),(W,E)]!#-----+       +-------+::         +------->!use r!-
:| *=================*|     v               |::                  *=====*:
:|           |        | *==================*|:,.........................,
:|           v        +>!send[(Inl(W,N),E)]!+:
:|     *===========*    *==================* :
:+---->!send[(N,E)]!--------------------------
:      *===========*                         :
,............................................,STOP
verify rev rev.2d
program area=1022
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|....................................,,.....|...................,
:r     v                        +--------+  ::rev  v                   :
:*=============*  *=======*     |        v  ::*=====================*  :
:!case N of E,S!->!split W!-----+    *=====*::!send[(Inr(),S),(N,E)]!+ :
:*=============*  *=======*        +>!use r!-:*=====================*v :
:++*=================*|            | *=====*::         |        *=====*:
-#>!send[(W,S),(W,E)]!#-----+      +-------+::         +------->!use r!-
:| *=================*|     v              |::                  *=====*:
:|           |       ++*==================*|:,.........................,
:|           v       +>!send[(Inl(W,N),E)]!+:
:|     *===========*   *==================* :
:+---->!send[(N,E)]!-------------------------
:      *===========*                        :
,...........................................,STOP
verify rev rev.2d
program area=1008
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|....................................,,.....|..................,
:r     v                        +--------+  ::rev  v                  :
:*=============*  *=======*     |        v  ::*=====================* :
:!case N of E,S!->!split W!-----+    *=====*::!send[(Inr(),S),(N,E)]!+:
:*=============*  *=======*        +>!use r!-:*=====================*|:
:++*=================*|            | *=====*::         |            ++:
-#>!send[(W,S),(W,E)]!#-----+      +-------+::         |            v :
:| *=================*|     v              |::         |       *=====*:
:|           |       ++*==================*|::         +------>!use r!-
:|           v       +>!send[(Inl(W,N),E)]!+::                 *=====*:
:|     *===========*   *==================* :,........................,
:+---->!send[(N,E)]!-------------------------
:      *===========*                        :
,...........................................,STOP
verify rev rev.2d
program area=994
---
rm rev.2d
/bin/umodem rev.2d STOP
,........|...................................,,.....|..................,
:r       v                         +---+     ::rev  v                  :
:       *=============*  *=======* |   v     ::*=====================* :
--+     !case N of E,S!->!split W!-+  *=====*::!send[(Inr(),S),(N,E)]!+:
: v     *=============*  *=======*  +>!use r!-:*=====================*|:
:*=================*|     |         | *=====*::         |            ++:
:!send[(N,S),(N,E)]!#-+   |         +-------+::         |            v :
:*=================*| |   v                 |::         |       *=====*:
:      |            v | *==================*|::         +------>!use r!-
:      | *===========*+>!send[(Inl(N,W),E)]!+::                 *=====*:
:      +>!send[(W,E)]!-+*==================* :,........................,
:        *===========* +----------------------
,............................................,STOP
verify rev rev.2d
program area=936
---
rm rev.2d
/bin/umodem rev.2d STOP
,........|...................................,
:r       v                         +---+     :
:       *=============*  *=======* |   v     :
--+     !case N of E,S!->!split W!-+  *=====*:
: v     *=============*  *=======*  +>!use r!-
:*=================*|     |         | *=====*:
:!send[(N,S),(N,E)]!#-+   |         +-------+:
:*=================*| |   v                 |:
:      |            v | *==================*|:
:      | *===========*+>!send[(Inl(N,W),E)]!+:
:      +>!send[(W,E)]!-+*==================* :
:        *===========* +----------------------
,............................................,
,....|................................,
:rev | *=====================*+-+     :
:    +>!send[(Inr(),S),(W,E)]!+ v     :
:      *=====================* *=====*:
:                           +->!use r!-
:                              *=====*:
,.....................................,STOP
verify rev rev.2d
program area=920
---
rm rev.2d
/bin/umodem rev.2d STOP
,........|...................................,
:r       v                         +---+     :
:       *=============*  *=======* |   v     :
--+     !case N of E,S!->!split W!-+  *=====*:
: v     *=============*  *=======*  +>!use r!-
:*=================*|     |         | *=====*:
:!send[(N,S),(N,E)]!#-+   |         +-------+:
:*=================*| |   v                 |:
:      |            v | *==================*|:
:      | *===========*+>!send[(Inl(N,W),E)]!+:
:      +>!send[(W,E)]!-+*==================* :
:        *===========* +----------------------
,............................................,
,....................|.....,
:rev                 v     :
:*===============*  *=====*:
:!send[(Inr(),E)]!->!use r!-
:*===============*  *=====*:
,..........................,STOP
verify rev rev.2d
program area=874
46*13+28*6
---
rm rev.2d
/bin/umodem rev.2d STOP
,.......|..........................................,
:r      v               *=======*                  :
:      *=============*+>!split W!------------+     :
--+    !case N of E,S!+ *=======*            |     :
: v    *=============* +--#------------------#------
:*=================*| ++  v                  |     :
:!send[(N,S),(N,E)]!#+| *==================* |     :
:*=================*v+#>!send[(Inl(N,W),S)]! v     :
:      | *===========*| *==================**=====*:
:      +>!send[(W,E)]!+                   +>!use r!-
:        *===========*                      *=====*:
,..................................................,
,....................|.....,
:rev                 v     :
:*===============*  *=====*:
:!send[(Inr(),E)]!->!use r!-
:*===============*  *=====*:
,..........................,STOP
verify rev rev.2d
program area=936
52*12+28*6
---
rm rev.2d
/bin/umodem rev.2d STOP
,.......|.......................................,
:r      v               *=======*               :
:      *=============*+>!split W!-------------+ :
--+    !case N of E,S!+ *=======*++           | :
: v    *=============* +-#-------+v           | :
:*=================*+--+ |       *===========*| :
:!send[(N,S),(N,E)]!-----#------>!send[(W,E)]!#--
:*=================*     v       *===========*v :
:      | *==================*            *=====*:
:      +>!send[(Inl(N,W),E)]!----------->!use r!-
:        *==================*            *=====*:
,...............................................,
,....................|.....,
:rev                 v     :
:*===============*  *=====*:
:!send[(Inr(),E)]!->!use r!-
:*===============*  *=====*:
,..........................,STOP
verify rev rev.2d
program area=882
49*12+28*6
---
rm rev.2d
/bin/umodem rev.2d STOP
,.......|.................................,
:r      v             +----------+        :
:      *=============*| *=======*|        :
--+    !case N of E,S!#>!split W!#------+ :
: v    *=============*| *=======*v      | :
:*=================*+-+  | *===========*| :
:!send[(N,S),(N,E)]!-----#>!send[(W,E)]!#--
:*=================*     v *===========*v :
:      | *==================*      *=====*:
:      +>!send[(Inl(N,W),E)]!----->!use r!-
:        *==================*      *=====*:
,.........................................,
,....................|.....,
:rev                 v     :
:*===============*  *=====*:
:!send[(Inr(),E)]!->!use r!-
:*===============*  *=====*:
,..........................,STOP
verify rev rev.2d
program area=774
*)
