datatype 'a list = Inl of 'a * 'a list | Inr of unit
fun r acc xs = case xs of
                   Inl (y,ys) => r (Inl (y,acc)) ys
                 | Inr () => acc
fun rev xs = r (Inr ()) xs
(*
rm rev.2d
/bin/umodem rev.2d STOP
,......|..............................................,
:r     v                                              :
:*=============*   *=======*                          :
:!case N of E,S!-->!split W!--------------------+     :
:*=============*   *=======*                    |     :
: |                       |                     |     :
: |                       v                     v     :
: | *=================*  *==================*  *=====*:
--#>!send[(W,S),(W,E)]!->!send[(Inl(N,W),E)]!->!use r!-
: | *=================*  *==================*  *=====*:
: |            |                                      :
: |            v                                      :
: |     *===========*                                 :
: +---->!send[(N,E)]!----------------------------------
:       *===========*                                 :
,.....................................................,
,.....|...................,
:rev  v                   :
:*=====================*  :
:!send[(Inr(),S),(N,E)]!+ :
:*=====================*v :
:         |        *=====*:
:         +------->!use r!-
:                  *=====*:
,.........................,STOP
verify rev rev.2d
program area=1375
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|.............................................,
:r     v                                             :
:*=============*  *=======*                          :
:!case N of E,S!->!split W!--------------------+     :
:*=============*  *=======*                    |     :
:++*=================*|                        |     :
-#>!send[(W,S),(W,E)]!#-----+                  |     :
:| *=================*|     v                  v     :
:|           |        | *==================*  *=====*:
:|           v        +>!send[(Inl(W,N),E)]!->!use r!-
:|     *===========*    *==================*  *=====*:
:+---->!send[(N,E)]!----------------------------------
:      *===========*                                 :
,....................................................,
,.....|...................,
:rev  v                   :
:*=====================*  :
:!send[(Inr(),S),(N,E)]!+ :
:*=====================*v :
:         |        *=====*:
:         +------->!use r!-
:                  *=====*:
,.........................,STOP
verify rev rev.2d
program area=1242
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|.....................................,
:r     v                        +---------+  :
:*=============*  *=======*     |         v  :
:!case N of E,S!->!split W!-----+     *=====*:
:*=============*  *=======*         +>!use r!-
:++*=================*|             | *=====*:
-#>!send[(W,S),(W,E)]!#-----+       +-------+:
:| *=================*|     v               |:
:|           |        | *==================*|:
:|           v        +>!send[(Inl(W,N),E)]!+:
:|     *===========*    *==================* :
:+---->!send[(N,E)]!--------------------------
:      *===========*                         :
,............................................,
,.....|...................,
:rev  v                   :
:*=====================*  :
:!send[(Inr(),S),(N,E)]!+ :
:*=====================*v :
:         |        *=====*:
:         +------->!use r!-
:                  *=====*:
,.........................,STOP
verify rev rev.2d
program area=1058
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|.....................................,,.....|...................,
:r     v                        +---------+  ::rev  v                   :
:*=============*  *=======*     |         v  ::*=====================*  :
:!case N of E,S!->!split W!-----+     *=====*::!send[(Inr(),S),(N,E)]!+ :
:*=============*  *=======*         +>!use r!-:*=====================*v :
:++*=================*|             | *=====*::         |        *=====*:
-#>!send[(W,S),(W,E)]!#-----+       +-------+::         +------->!use r!-
:| *=================*|     v               |::                  *=====*:
:|           |        | *==================*|:,.........................,
:|           v        +>!send[(Inl(W,N),E)]!+:
:|     *===========*    *==================* :
:+---->!send[(N,E)]!--------------------------
:      *===========*                         :
,............................................,STOP
verify rev rev.2d
program area=1022
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|....................................,,.....|...................,
:r     v                        +--------+  ::rev  v                   :
:*=============*  *=======*     |        v  ::*=====================*  :
:!case N of E,S!->!split W!-----+    *=====*::!send[(Inr(),S),(N,E)]!+ :
:*=============*  *=======*        +>!use r!-:*=====================*v :
:++*=================*|            | *=====*::         |        *=====*:
-#>!send[(W,S),(W,E)]!#-----+      +-------+::         +------->!use r!-
:| *=================*|     v              |::                  *=====*:
:|           |       ++*==================*|:,.........................,
:|           v       +>!send[(Inl(W,N),E)]!+:
:|     *===========*   *==================* :
:+---->!send[(N,E)]!-------------------------
:      *===========*                        :
,...........................................,STOP
verify rev rev.2d
program area=1008
---
rm rev.2d
/bin/umodem rev.2d STOP
,......|....................................,,.....|..................,
:r     v                        +--------+  ::rev  v                  :
:*=============*  *=======*     |        v  ::*=====================* :
:!case N of E,S!->!split W!-----+    *=====*::!send[(Inr(),S),(N,E)]!+:
:*=============*  *=======*        +>!use r!-:*=====================*|:
:++*=================*|            | *=====*::         |            ++:
-#>!send[(W,S),(W,E)]!#-----+      +-------+::         |            v :
:| *=================*|     v              |::         |       *=====*:
:|           |       ++*==================*|::         +------>!use r!-
:|           v       +>!send[(Inl(W,N),E)]!+::                 *=====*:
:|     *===========*   *==================* :,........................,
:+---->!send[(N,E)]!-------------------------
:      *===========*                        :
,...........................................,STOP
verify rev rev.2d
program area=994
---
rm rev.2d
/bin/umodem rev.2d STOP
,........|...................................,,.....|..................,
:r       v                         +---+     ::rev  v                  :
:       *=============*  *=======* |   v     ::*=====================* :
--+     !case N of E,S!->!split W!-+  *=====*::!send[(Inr(),S),(N,E)]!+:
: v     *=============*  *=======*  +>!use r!-:*=====================*|:
:*=================*|     |         | *=====*::         |            ++:
:!send[(N,S),(N,E)]!#-+   |         +-------+::         |            v :
:*=================*| |   v                 |::         |       *=====*:
:      |            v | *==================*|::         +------>!use r!-
:      | *===========*+>!send[(Inl(N,W),E)]!+::                 *=====*:
:      +>!send[(W,E)]!-+*==================* :,........................,
:        *===========* +----------------------
,............................................,STOP
verify rev rev.2d
program area=936
*)
